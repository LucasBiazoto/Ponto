<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gest√£o de Pontos - Dra. Thamiris Araujo</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root { 
            --rosa: #d68c9a; 
            --rosa-claro: #fce4ec; 
            --verde: #2e7d32;
            --verde-claro: #e8f5e9;
            --texto: #5a4a4d; 
            --fundo: #fff5f7;
        }

        body { font-family: 'Poppins', sans-serif; background-color: var(--fundo); margin: 0; padding: 20px; color: var(--texto); }
        .container { max-width: 1000px; margin: auto; background: white; padding: 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); }
        
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; border-bottom: 2px solid var(--rosa-claro); padding-bottom: 15px; }
        h2 { color: var(--rosa); margin: 0; font-size: 22px; }

        /* Cards de Resumo */
        .resumo-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 30px; }
        .card-resumo { padding: 15px; border-radius: 15px; text-align: center; border: 1px solid var(--rosa-claro); }
        .card-resumo.total { background: var(--rosa-claro); }
        .card-resumo.extra { background: var(--verde-claro); color: var(--verde); border-color: #c8e6c9; }
        .card-resumo strong { font-size: 20px; display: block; }

        /* Bot√µes */
        .actions-bar { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
        .btn { padding: 10px 20px; border-radius: 10px; border: none; cursor: pointer; font-weight: 600; text-decoration: none; font-size: 14px; transition: 0.3s; display: inline-flex; align-items: center; gap: 8px; }
        .btn-relatorio { background: var(--rosa); color: white; }
        .btn-backup { background: white; color: var(--rosa); border: 1px solid var(--rosa); }
        .btn-manual { background: var(--texto); color: white; }
        .btn:hover { opacity: 0.8; transform: translateY(-1px); }

        /* Tabela */
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th { text-align: left; padding: 15px; border-bottom: 2px solid var(--rosa-claro); color: var(--rosa); font-size: 13px; text-transform: uppercase; }
        td { padding: 15px; border-bottom: 1px solid #eee; font-size: 14px; }
        .cor-entrada { color: var(--verde); font-weight: 600; }
        .cor-saida { color: var(--rosa); font-weight: 600; }
        .btn-excluir { color: #ff5252; text-decoration: none; font-size: 16px; }

        /* Modal */
        .modal { display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.4); }
        .modal-content { background: white; margin: 10% auto; padding: 30px; width: 90%; max-width: 400px; border-radius: 20px; position: relative; }
        .modal-content input, .modal-content select { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 10px; box-sizing: border-box; }
        
        .sair-link { color: #999; text-decoration: none; font-size: 14px; }
        .sair-link:hover { color: var(--rosa); }
    </style>
</head>
<body>

    <div class="container">
        <div class="header">
            <h2>üå∏ Painel Administrativo</h2>
            <a href="/logout" class="sair-link">Sair do Sistema</a>
        </div>

        <div class="resumo-grid">
            <div class="card-resumo">
                <small>Dias Trabalhados</small>
                <strong>{{ dias }}</strong>
            </div>
            <div class="card-resumo total">
                <small>Total de Horas</small>
                <strong>{{ total_h }}h</strong>
            </div>
            <div class="card-resumo extra">
                <small>Horas Extras (Meta 6h)</small>
                <strong>{{ extras }}h</strong>
            </div>
        </div>

        <div class="actions-bar">
            <a href="/exportar_pdf?mes={{ mes_atual }}" class="btn btn-relatorio">üìÑ Extrair PDF</a>
            <button onclick="alert('Backup de seguran√ßa realizado com sucesso!')" class="btn btn-backup">üíæ Backup Sistema</button>
            <button onclick="document.getElementById('modalManual').style.display='block'" class="btn btn-manual">‚ûï Inserir Manual</button>
            
            <form method="GET" style="margin-left: auto;">
                <select name="mes" onchange="this.form.submit()" style="padding: 10px; border-radius: 10px; border: 1px solid var(--rosa-claro);">
                    <option value="01" {% if mes_atual == '01' %}selected{% endif %}>Janeiro</option>
                    <option value="02" {% if mes_atual == '02' %}selected{% endif %}>Fevereiro</option>
                    <option value="03" {% if mes_atual == '03' %}selected{% endif %}>Mar√ßo</option>
                    <option value="04" {% if mes_atual == '04' %}selected{% endif %}>Abril</option>
                    <option value="05" {% if mes_atual == '05' %}selected{% endif %}>Maio</option>
                    <option value="06" {% if mes_atual == '06' %}selected{% endif %}>Junho</option>
                    <option value="07" {% if mes_atual == '07' %}selected{% endif %}>Julho</option>
                    <option value="08" {% if mes_atual == '08' %}selected{% endif %}>Agosto</option>
                    <option value="09" {% if mes_atual == '09' %}selected{% endif %}>Setembro</option>
                    <option value="10" {% if mes_atual == '10' %}selected{% endif %}>Outubro</option>
                    <option value="11" {% if mes_atual == '11' %}selected{% endif %}>Novembro</option>
                    <option value="12" {% if mes_atual == '12' %}selected{% endif %}>Dezembro</option>
                </select>
            </form>
        </div>

        <table>
            <thead>
                <tr>
                    <th>Data</th>
                    <th>Tipo</th>
                    <th>Hora</th>
                    <th>Obs.</th>
                    <th>A√ß√£o</th>
                </tr>
            </thead>
            <tbody>
                {% for r in registros %}
                <tr>
                    <td>{{ r.data }}</td>
                    <td class="{% if r.tipo == 'Entrada' %}cor-entrada{% else %}cor-saida{% endif %}">
                        {{ r.tipo }}
                    </td>
                    <td>{{ r.hora }}</td>
                    <td><small style="color: #999;">{{ r.geo }}</small></td>
                    <td>
                        <a href="/excluir/{{ r.id }}" class="btn-excluir" onclick="return confirm('Deseja excluir esta marca√ß√£o?')">üóëÔ∏è</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div id="modalManual" class="modal">
        <div class="modal-content">
            <h3 style="color: var(--rosa); margin-top: 0;">Lan√ßamento Manual</h3>
            <form action="/inserir_manual" method="POST">
                <label><small>Data:</small></label>
                <input type="date" name="data" required>
                
                <label><small>Hora:</small></label>
                <input type="time" name="hora" required>
                
                <label><small>Tipo de Registro:</small></label>
                <select name="tipo">
                    <option value="Entrada">Entrada</option>
                    <option value="Sa√≠da">Sa√≠da</option>
                </select>
                
                <div style="display: flex; gap: 10px; margin-top: 10px;">
                    <button type="submit" class="btn btn-relatorio" style="flex: 1; justify-content: center;">Salvar</button>
                    <button type="button" onclick="document.getElementById('modalManual').style.display='none'" class="btn" style="flex: 1; justify-content: center; background: #eee;">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Fecha o modal se clicar fora dele
        window.onclick = function(event) {
            let modal = document.getElementById('modalManual');
            if (event.target == modal) { modal.style.display = "none"; }
        }
    </script>
</body>
</html>