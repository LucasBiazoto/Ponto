<div class="card">
    <h1 style="color: #d68c9a; margin-bottom: 0;">ğŸŒ¸ Dra. Thamiris Araujo</h1>
    <p style="color: #888; margin-top: 5px; margin-bottom: 25px;">Estetica avanÃ§ada</p>

    {% with messages = get_flashed_messages() %}
      {% if messages %}{% for msg in messages %}<div class="flash">{{ msg }}</div>{% endfor %}{% endif %}
    {% endwith %}

    <form id="formPonto" action="/bater_ponto" method="POST">
        <input type="hidden" name="colaboradora" value="Esther Julia">
        <input type="hidden" id="lat" name="lat" value="">
        <input type="hidden" id="lon" name="lon" value="">
        
        <h3 style="color: #5a4a4d; font-size: 18px;">OlÃ¡, Esther Julia!</h3>
        
        <button type="button" onclick="capturarEEnviar('Entrada')" class="btn btn-entrada">Bater Entrada</button>
        <button type="button" onclick="capturarEEnviar('SaÃ­da')" class="btn btn-saida">Bater SaÃ­da</button>
    </form>
    <a href="/login" class="acesso-invisivel">Acesso Restrito</a>
</div>

<script>
function capturarEEnviar(tipo) {
    const form = document.getElementById('formPonto');
    const inputTipo = document.createElement('input');
    inputTipo.type = 'hidden';
    inputTipo.name = 'tipo';
    inputTipo.value = tipo;
    form.appendChild(inputTipo);

    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition((pos) => {
            document.getElementById('lat').value = pos.coords.latitude;
            document.getElementById('lon').value = pos.coords.longitude;
            form.submit();
        }, () => { form.submit(); }); // Envia mesmo se o GPS falhar
    } else { form.submit(); }
}
</script>