<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gest√£o Avan√ßada - Dra Thamiris Araujo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body { background-color: #fdf2f2; font-family: 'Poppins', sans-serif; color: #5a4a4a; }
        .navbar-clinica { background: white; box-shadow: 0 2px 10px rgba(212,163,163,0.1); padding: 15px 0; }
        .navbar-brand { color: #d4a3a3 !important; font-weight: 600; }
        .card-gestao { border: none; border-radius: 20px; box-shadow: 0 10px 30px rgba(212,163,163,0.1); background: white; padding: 25px; }
        .thead-rosa { background-color: #d4a3a3; color: white; }
        .btn-rosa { background-color: #d4a3a3; color: white; border: none; }
        .btn-rosa:hover { background-color: #b88d8d; color: white; }
        .badge-jornada { font-size: 11px; padding: 5px 10px; border-radius: 10px; }
        .extra { background-color: #e8f5e9; color: #1b5e20; } /* Verde para extras */
        .falta { background-color: #fce4ec; color: #c2185b; } /* Rosa escuro para menos de 6h */
        .btn-excluir { color: #e57373; text-decoration: none; font-size: 18px; }
        .btn-excluir:hover { color: #d32f2f; }
    </style>
</head>
<body>

<nav class="navbar navbar-clinica mb-4">
    <div class="container d-flex justify-content-between">
        <span class="navbar-brand">üå∏ Painel de Gest√£o - Dra Thamiris Araujo</span>
        <a href="/" class="btn btn-outline-secondary btn-sm">Sair</a>
    </div>
</nav>

<div class="container">
    <div class="row g-3 mb-4">
        <div class="col-md-4">
            <div class="card-gestao p-3">
                <h6>Filtro de Per√≠odo</h6>
                <select class="form-select border-0 bg-light" id="filtroMes">
                    <option value="">√öltimos 12 Meses</option>
                    <option value="01">Janeiro 2026</option>
                    <option value="12">Dezembro 2025</option>
                </select>
            </div>
        </div>
        <div class="col-md-8 text-end d-flex align-items-end justify-content-end">
            <button class="btn btn-rosa shadow-sm" data-bs-toggle="modal" data-bs-target="#modalManual">
                + Adicionar Marca√ß√£o Manual
            </button>
        </div>
    </div>

    <div class="card-gestao">
        <h5 class="mb-4">Relat√≥rio de Frequ√™ncia (Fuso: S√£o Paulo)</h5>
        <div class="table-responsive">
            <table class="table table-hover align-middle">
                <thead class="thead-rosa">
                    <tr>
                        <th>Colaboradora</th>
                        <th>Entrada</th>
                        <th>Sa√≠da</th>
                        <th>Jornada (Ref: 6h)</th>
                        <th>Localiza√ß√£o</th>
                        <th>A√ß√µes</th>
                    </tr>
                </thead>
                <tbody>
                    {% for p in pontos %}
                    <tr>
                        <td><strong>{{ p.nome }}</strong></td>
                        <td>{{ p.entrada.strftime('%d/%m/%Y %H:%M') if p.entrada else '---' }}</td>
                        <td>{{ p.saida.strftime('%d/%m/%Y %H:%M') if p.saida else 'Em aberto' }}</td>
                        <td>
                            {% if p.entrada and p.saida %}
                                {% set horas = ((p.saida - p.entrada).total_seconds() / 3600) | round(2) %}
                                <span class="badge badge-jornada {{ 'extra' if horas >= 6 else 'falta' }}">
                                    {{ horas }}h trabalhas {{ '(Extra)' if horas > 6 }}
                                </span>
                            {% else %}
                                <span class="text-muted">Calculando...</span>
                            {% endif %}
                        </td>
                        <td>
                            <small class="text-muted">üìç Ver Mapa</small>
                        </td>
                        <td>
                            <a href="/excluir/{{ p.id }}" class="btn-excluir" title="Excluir Marca√ß√£o" 
                               onclick="return confirm('Dra. Thamiris, deseja mesmo excluir este registro?')">
                                üóëÔ∏è
                            </a>
                        </td>
                    </tr>
                    {% else %}
                    <tr>
                        <td colspan="6" class="text-center py-5">Nenhum registro encontrado.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<div class="modal fade" id="modalManual" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content" style="border-radius: 20px;">
            <form action="/adicionar_manual" method="POST">
                <div class="modal-header border-0">
                    <h5 class="modal-title" style="color: #d4a3a3;">Adicionar Ponto Manual</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">Funcion√°ria</label>
                        <select name="funcionario_id" class="form-select">
                            <option value="1">Esther Julia</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Hor√°rio de Entrada</label>
                        <input type="datetime-local" name="entrada" class="form-control" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Hor√°rio de Sa√≠da</label>
                        <input type="datetime-local" name="saida" class="form-control">
                    </div>
                </div>
                <div class="modal-footer border-0">
                    <button type="submit" class="btn btn-rosa w-100">Salvar Registro</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>