<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Gest√£o Dra Thamiris Araujo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body { background-color: #fdf2f2; font-family: 'Poppins', sans-serif; }
        .navbar-clinica { background: white; box-shadow: 0 2px 10px rgba(212,163,163,0.1); padding: 15px 0; }
        .card-gestao { background: white; border-radius: 20px; padding: 25px; box-shadow: 0 10px 30px rgba(212,163,163,0.05); }
        .thead-rosa { background-color: #d4a3a3; color: white; }
        .btn-rosa { background-color: #d4a3a3; color: white; border: none; border-radius: 10px; }
        .btn-rosa:hover { background-color: #b88d8d; color: white; }
        .extra-badge { background-color: #e8f5e9; color: #2e7d32; padding: 5px 10px; border-radius: 8px; font-weight: 600; font-size: 12px; }
    </style>
</head>
<body>

<nav class="navbar navbar-clinica mb-4">
    <div class="container d-flex justify-content-between">
        <span style="color: #d4a3a3; font-weight: 600;">üå∏ Gest√£o - Penha (Av. Amador Bueno da Veiga, 1230)</span>
        <a href="/" class="btn btn-outline-secondary btn-sm">Sair</a>
    </div>
</nav>

<div class="container">
    <div class="row mb-4 align-items-end">
        <div class="col-md-3">
            <label class="form-label small text-muted">Filtrar por M√™s</label>
            <select class="form-select border-0 shadow-sm" onchange="location = '/painel_gestao?senha=8340&mes=' + this.value;">
                <option value="">Todos os Meses</option>
                {% for m in range(1, 13) %}
                <option value="{{ m }}">M√™s {{ m }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="col-md-9 text-end">
            <button class="btn btn-rosa px-4" data-bs-toggle="modal" data-bs-target="#modalManual">+ Inserir Marca√ß√£o Manual</button>
        </div>
    </div>

    <div class="card-gestao">
        <table class="table table-hover align-middle">
            <thead class="thead-rosa">
                <tr>
                    <th>Colaboradora</th>
                    <th>Entrada</th>
                    <th>Sa√≠da</th>
                    <th>Jornada (6h)</th>
                    <th>A√ß√µes</th>
                </tr>
            </thead>
            <tbody>
                {% for p in pontos %}
                <tr>
                    <td><strong>{{ p.nome }}</strong></td>
                    <td>{{ p.entrada.strftime('%d/%m/%Y %H:%M') }}</td>
                    <td>{{ p.saida.strftime('%d/%m/%Y %H:%M') if p.saida else '---' }}</td>
                    <td>
                        {% if p.entrada and p.saida %}
                            {% set total_segundos = (p.saida - p.entrada).total_seconds() %}
                            {% set horas = (total_segundos / 3600) | round(2) %}
                            {% if horas > 6 %}
                                <span class="extra-badge">Extra: +{{ (horas - 6) | round(2) }}h</span>
                            {% else %}
                                <span class="text-muted">{{ horas }}h totais</span>
                            {% endif %}
                        {% else %}
                            <span class="badge bg-light text-dark">Em curso</span>
                        {% endif %}
                    </td>
                    <td>
                        <a href="/excluir/{{ p.id }}" class="text-danger" onclick="return confirm('Deseja excluir?')">üóëÔ∏è</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<div class="modal fade" id="modalManual" tabindex="-1">
    <div class="modal-dialog">
        <form action="/adicionar_manual" method="POST" class="modal-content" style="border-radius: 20px;">
            <div class="modal-header border-0"><h5>Nova Marca√ß√£o Manual</h5></div>
            <div class="modal-body">
                <label class="small">Funcion√°ria</label>
                <select name="funcionario_id" class="form-select mb-3">
                    <option value="1">Esther Julia</option>
                </select>
                <label class="small">Entrada (Sem segundos)</label>
                <input type="datetime-local" name="entrada" class="form-control mb-3" required>
                <label class="small">Sa√≠da (Opcional)</label>
                <input type="datetime-local" name="saida" class="form-control">
            </div>
            <div class="modal-footer border-0">
                <button type="submit" class="btn btn-rosa w-100">Salvar no Hist√≥rico</button>
            </div>
        </form>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>